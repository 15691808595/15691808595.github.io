<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>npm发布包 | 前端知识体系</title>
    <meta name="description" content="个人总结的前端知识体系">
    
    
    <link rel="preload" href="/assets/css/24.styles.1d6cbc9d.css" as="style"><link rel="preload" href="/assets/js/app.687d257c.js" as="script"><link rel="preload" href="/assets/js/34.5cabc593.js" as="script"><link rel="preload" href="/assets/js/65.19408c2b.js" as="script"><link rel="prefetch" href="/assets/js/0.66d21b61.js"><link rel="prefetch" href="/assets/js/1.5f0c34b5.js"><link rel="prefetch" href="/assets/js/10.1d045e0c.js"><link rel="prefetch" href="/assets/js/11.7bffae9e.js"><link rel="prefetch" href="/assets/js/12.232c1e2b.js"><link rel="prefetch" href="/assets/js/13.1c0b4d07.js"><link rel="prefetch" href="/assets/js/14.b2db16ad.js"><link rel="prefetch" href="/assets/js/15.774f4b58.js"><link rel="prefetch" href="/assets/js/16.a34c6090.js"><link rel="prefetch" href="/assets/js/17.c8ddf23e.js"><link rel="prefetch" href="/assets/js/18.8a7aa0dd.js"><link rel="prefetch" href="/assets/js/19.ad6651a0.js"><link rel="prefetch" href="/assets/js/2.57577040.js"><link rel="prefetch" href="/assets/js/20.515ab810.js"><link rel="prefetch" href="/assets/js/21.283de1ff.js"><link rel="prefetch" href="/assets/js/22.a5d510b1.js"><link rel="prefetch" href="/assets/js/23.122ab535.js"><link rel="prefetch" href="/assets/js/25.5d18e673.js"><link rel="prefetch" href="/assets/js/26.aabe3be5.js"><link rel="prefetch" href="/assets/js/27.a21f5f67.js"><link rel="prefetch" href="/assets/js/28.08a43f23.js"><link rel="prefetch" href="/assets/js/29.f90e2886.js"><link rel="prefetch" href="/assets/js/3.f6b34011.js"><link rel="prefetch" href="/assets/js/30.e1abee41.js"><link rel="prefetch" href="/assets/js/31.568eb1c3.js"><link rel="prefetch" href="/assets/js/32.426650aa.js"><link rel="prefetch" href="/assets/js/35.45176416.js"><link rel="prefetch" href="/assets/js/36.f4dd6052.js"><link rel="prefetch" href="/assets/js/37.0a574988.js"><link rel="prefetch" href="/assets/js/38.86c3548d.js"><link rel="prefetch" href="/assets/js/39.c87d2529.js"><link rel="prefetch" href="/assets/js/4.938062f0.js"><link rel="prefetch" href="/assets/js/40.27ae5466.js"><link rel="prefetch" href="/assets/js/41.e0a2d784.js"><link rel="prefetch" href="/assets/js/42.2a58f128.js"><link rel="prefetch" href="/assets/js/43.a3d26ec1.js"><link rel="prefetch" href="/assets/js/44.46069162.js"><link rel="prefetch" href="/assets/js/45.0718ba34.js"><link rel="prefetch" href="/assets/js/46.b96b1272.js"><link rel="prefetch" href="/assets/js/47.04ec8ce0.js"><link rel="prefetch" href="/assets/js/48.c322c277.js"><link rel="prefetch" href="/assets/js/49.0e537941.js"><link rel="prefetch" href="/assets/js/5.ac18ecdc.js"><link rel="prefetch" href="/assets/js/50.2026f6c8.js"><link rel="prefetch" href="/assets/js/51.fb4674e9.js"><link rel="prefetch" href="/assets/js/52.0dd2d685.js"><link rel="prefetch" href="/assets/js/53.bec36a33.js"><link rel="prefetch" href="/assets/js/54.73b1f450.js"><link rel="prefetch" href="/assets/js/55.e32a138d.js"><link rel="prefetch" href="/assets/js/56.ad621d83.js"><link rel="prefetch" href="/assets/js/57.732d6759.js"><link rel="prefetch" href="/assets/js/58.c19e3528.js"><link rel="prefetch" href="/assets/js/59.ce3b0a84.js"><link rel="prefetch" href="/assets/js/6.88abfe95.js"><link rel="prefetch" href="/assets/js/60.3df27eb7.js"><link rel="prefetch" href="/assets/js/61.cd07d819.js"><link rel="prefetch" href="/assets/js/62.66e17fa3.js"><link rel="prefetch" href="/assets/js/63.8264c7fc.js"><link rel="prefetch" href="/assets/js/64.2ad9411f.js"><link rel="prefetch" href="/assets/js/66.0357f244.js"><link rel="prefetch" href="/assets/js/67.82af712b.js"><link rel="prefetch" href="/assets/js/68.edb951d5.js"><link rel="prefetch" href="/assets/js/69.c4ec197c.js"><link rel="prefetch" href="/assets/js/7.d74c60bf.js"><link rel="prefetch" href="/assets/js/70.1570dce0.js"><link rel="prefetch" href="/assets/js/71.2dacf0fc.js"><link rel="prefetch" href="/assets/js/72.2882c60a.js"><link rel="prefetch" href="/assets/js/73.0cacfd68.js"><link rel="prefetch" href="/assets/js/74.568e8c6a.js"><link rel="prefetch" href="/assets/js/75.5ad28ea4.js"><link rel="prefetch" href="/assets/js/76.e40497f8.js"><link rel="prefetch" href="/assets/js/77.43bd9103.js"><link rel="prefetch" href="/assets/js/78.eeba4517.js"><link rel="prefetch" href="/assets/js/79.40bb5355.js"><link rel="prefetch" href="/assets/js/8.6dd596f0.js"><link rel="prefetch" href="/assets/js/80.f53522dc.js"><link rel="prefetch" href="/assets/js/81.5a0eaa48.js"><link rel="prefetch" href="/assets/js/82.e5e5bcbf.js"><link rel="prefetch" href="/assets/js/83.7afaa11a.js"><link rel="prefetch" href="/assets/js/84.a3251f37.js"><link rel="prefetch" href="/assets/js/85.407ccdbe.js"><link rel="prefetch" href="/assets/js/86.f8427e50.js"><link rel="prefetch" href="/assets/js/87.697c07bc.js"><link rel="prefetch" href="/assets/js/88.18bf070e.js"><link rel="prefetch" href="/assets/js/89.fef89fcb.js"><link rel="prefetch" href="/assets/js/9.f4a71fa1.js"><link rel="prefetch" href="/assets/js/90.d517fd74.js"><link rel="prefetch" href="/assets/js/91.bcbc0d28.js"><link rel="prefetch" href="/assets/js/92.ab5c50d1.js"><link rel="prefetch" href="/assets/js/93.d4363614.js"><link rel="prefetch" href="/assets/js/94.48704c37.js"><link rel="prefetch" href="/assets/js/95.1236d3e1.js"><link rel="prefetch" href="/assets/js/96.4b51afcc.js"><link rel="prefetch" href="/assets/js/97.899f8f02.js"><link rel="prefetch" href="/assets/js/98.6fcb1375.js"><link rel="prefetch" href="/assets/js/99.d79fe1a2.js">
    <link rel="stylesheet" href="/assets/css/24.styles.1d6cbc9d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">前端知识体系</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="http://www.liuweibo.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/Weibozzz/Weibozzz.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="http://www.liuweibo.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/Weibozzz/Weibozzz.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>npm发布包</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/%E5%85%B6%E4%BB%96/npm%E5%8F%91%E5%B8%83%E5%8C%85%E4%B8%80%E4%BA%9B%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E5%92%8C%E6%B5%81%E7%A8%8B.html#初始化" class="sidebar-link">初始化</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/%E5%85%B6%E4%BB%96/npm%E5%8F%91%E5%B8%83%E5%8C%85%E4%B8%80%E4%BA%9B%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E5%92%8C%E6%B5%81%E7%A8%8B.html#新建入口文件-index-js" class="sidebar-link">新建入口文件 index.js</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/%E5%85%B6%E4%BB%96/npm%E5%8F%91%E5%B8%83%E5%8C%85%E4%B8%80%E4%BA%9B%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E5%92%8C%E6%B5%81%E7%A8%8B.html#发布" class="sidebar-link">发布</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/%E5%85%B6%E4%BB%96/npm%E5%8F%91%E5%B8%83%E5%8C%85%E4%B8%80%E4%BA%9B%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E5%92%8C%E6%B5%81%E7%A8%8B.html#更新发布" class="sidebar-link">更新发布</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/%E5%85%B6%E4%BB%96/npm%E5%8F%91%E5%B8%83%E5%8C%85%E4%B8%80%E4%BA%9B%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E5%92%8C%E6%B5%81%E7%A8%8B.html#如果发布的有es6代码" class="sidebar-link">如果发布的有es6代码</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/%E5%85%B6%E4%BB%96/npm%E5%8F%91%E5%B8%83%E5%8C%85%E4%B8%80%E4%BA%9B%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E5%92%8C%E6%B5%81%E7%A8%8B.html#错误" class="sidebar-link">错误</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/%E5%85%B6%E4%BB%96/npm%E5%8F%91%E5%B8%83%E5%8C%85%E4%B8%80%E4%BA%9B%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E5%92%8C%E6%B5%81%E7%A8%8B.html#npm包来制作命令行工具的原理" class="sidebar-link">npm包来制作命令行工具的原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/%E5%85%B6%E4%BB%96/npm%E5%8F%91%E5%B8%83%E5%8C%85%E4%B8%80%E4%BA%9B%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E5%92%8C%E6%B5%81%E7%A8%8B.html#unix-like-平台" class="sidebar-link">Unix-like 平台</a></li><li class="sidebar-sub-header"><a href="/docs/%E5%85%B6%E4%BB%96/npm%E5%8F%91%E5%B8%83%E5%8C%85%E4%B8%80%E4%BA%9B%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E5%92%8C%E6%B5%81%E7%A8%8B.html#windows-平台" class="sidebar-link">Windows 平台</a></li><li class="sidebar-sub-header"><a href="/docs/%E5%85%B6%E4%BB%96/npm%E5%8F%91%E5%B8%83%E5%8C%85%E4%B8%80%E4%BA%9B%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E5%92%8C%E6%B5%81%E7%A8%8B.html#本地开发-cli-测试" class="sidebar-link">本地开发 cli 测试</a></li></ul></li><li><a href="/docs/%E5%85%B6%E4%BB%96/npm%E5%8F%91%E5%B8%83%E5%8C%85%E4%B8%80%E4%BA%9B%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E5%92%8C%E6%B5%81%E7%A8%8B.html#引用" class="sidebar-link">引用</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/%E5%85%B6%E4%BB%96/npm%E5%8F%91%E5%B8%83%E5%8C%85%E4%B8%80%E4%BA%9B%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E5%92%8C%E6%B5%81%E7%A8%8B.html#今日图-猜猜这个是谁？" class="sidebar-link">今日图 - 猜猜这个是谁？</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="npm发布包"><a href="#npm发布包" class="header-anchor">#</a> npm发布包</h1> <h2 id="初始化"><a href="#初始化" class="header-anchor">#</a> 初始化</h2> <p>在<a href="https://www.npmjs.com/" target="_blank" rel="noopener noreferrer">https://www.npmjs.com/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>这里注册登录，
起一个名字，比如http-auth-zfb,首先查询是否已存在</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">mkdir</span> http-auth-zfb
<span class="token builtin class-name">cd</span> http-auth-zfb
<span class="token function">npm</span> init -y
</code></pre></div><h2 id="新建入口文件-index-js"><a href="#新建入口文件-index-js" class="header-anchor">#</a> 新建入口文件 index.js</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//index.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./lib/index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>要发布的文件放到lib文件夹下</p> <h2 id="发布"><a href="#发布" class="header-anchor">#</a> 发布</h2> <p><code>npm login</code>登录会填写你在<code>npmjs.com</code>注册的用户名密码邮箱等信息。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> login
<span class="token function">npm</span> publish
</code></pre></div><h2 id="更新发布"><a href="#更新发布" class="header-anchor">#</a> 更新发布</h2> <p>只需要更改版本号然后<code>npm publish</code></p> <h2 id="如果发布的有es6代码"><a href="#如果发布的有es6代码" class="header-anchor">#</a> 如果发布的有es6代码</h2> <p>新建<code>src</code>目录，把原始文件（es6代码），放入<code>src</code>,需要<code>babael</code>转化</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;babel src --out-dir lib&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;babel-cli&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^6.26.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;babel-plugin-transform-runtime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^6.23.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;babel-preset-es2015&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^6.24.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;babel-preset-stage-3&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^6.24.1&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;transform-runtime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^0.0.0&quot;</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>发布前，执行<code>npm run build</code>转化后的代码会在lib下面，更改版本号，在执行<code>npm publish</code></p> <h2 id="错误"><a href="#错误" class="header-anchor">#</a> 错误</h2> <p><code>npm ERR! publish Failed PUT 401</code>
解决过程：</p> <ol><li><p>检查仓库是否被设成了淘宝镜像库
<code>npm config get registry</code></p></li> <li><p>如是，则设回原仓库
<code>npm config set registry=http://registry.npmjs.org</code></p></li> <li><p>登录账号（如未登录）
<code>npm login</code> 或者添加用户 <code>npm adduser</code></p></li> <li><p>再次发布
<code>npm publish</code></p></li> <li><p>如发布成功，则再次将仓库地址设为淘宝镜像地址
<code>npm config set registry=https://registry.npm.taobao.org/</code></p></li></ol> <h2 id="npm包来制作命令行工具的原理"><a href="#npm包来制作命令行工具的原理" class="header-anchor">#</a> npm包来制作命令行工具的原理</h2> <blockquote><p>用过构建工具的亲们知道，通常通过全局安装一个 xxx-cli 的 npm 包，
就能在命令行用命令进行构建。那么这个 npm 包如何变成一个可执行的命令呢？</p></blockquote> <p>1.使用 <code>npm init</code> 初始化一个项目目录 <code>my-cli</code>。</p> <p>2.在 <code>package.json</code> 中添加或者编辑 <code>bin</code> 字段：</p> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;name&quot;: &quot;my-cli&quot;,
  ...,
  &quot;bin&quot;: {
    &quot;command-name&quot;: &quot;jsfile&quot; // path of jsfile relative to package.json
  },
  ...
}
</code></pre></div><p><code>commandName</code> 就是命令的名字，<code>jsfile</code> 就是当用户键入命令时的处理程序。</p> <p>3.代码开发。必须在 <code>jsfile</code> 文件的第一行写这行命令 <code>#!/usr/bin/env node</code>，譬如：</p> <div class="language-js extra-class"><pre class="language-js"><code>#<span class="token operator">!</span><span class="token operator">/</span>usr<span class="token operator">/</span>bin<span class="token operator">/</span>env node
<span class="token keyword">const</span> program <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'commander'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> packageJson <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../package'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> defaultJsProcessors <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token string">'react'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> defaultStyleProcessors <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token string">'sasslike'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> defaultWebpackVersion <span class="token operator">=</span> <span class="token string">'4'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">parseListArgv</span><span class="token punctuation">(</span> <span class="token parameter">val</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> val <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> val<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span> <span class="token string">','</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

program
  <span class="token punctuation">.</span><span class="token function">version</span><span class="token punctuation">(</span> packageJson<span class="token punctuation">.</span>version<span class="token punctuation">,</span> <span class="token string">'-v, --version'</span> <span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span> <span class="token string">'-u, --use-version &lt;version-number&gt;'</span><span class="token punctuation">,</span> <span class="token string">'Webpack version'</span> <span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span> <span class="token string">'-j, --js-processors &lt;processors&gt;'</span><span class="token punctuation">,</span> <span class="token string">'Specify javascript processors'</span><span class="token punctuation">,</span> parseListArgv <span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span> <span class="token string">'-s, --style-processors &lt;processors&gt;'</span><span class="token punctuation">,</span> <span class="token string">'Specify style(css,image,fonts) processors'</span><span class="token punctuation">,</span> parseListArgv <span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span> <span class="token string">'--no-install'</span><span class="token punctuation">,</span> <span class="token string">'Do not install devDependncies package'</span> <span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span> process<span class="token punctuation">.</span>argv <span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">let</span> jsProcessors <span class="token operator">=</span> program<span class="token punctuation">.</span>jsProcessors <span class="token operator">||</span> defaultJsProcessors<span class="token punctuation">;</span>
<span class="token keyword">let</span> styleProcessors <span class="token operator">=</span> program<span class="token punctuation">.</span>styleProcessors <span class="token operator">||</span> defaultStyleProcessors<span class="token punctuation">;</span>
<span class="token keyword">let</span> webpackVersion <span class="token operator">=</span> program<span class="token punctuation">.</span>useVersion <span class="token operator">||</span> defaultWebpackVersion<span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span> webpackVersion<span class="token operator">==</span><span class="token string">'4'</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// code</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment">// code</span>
<span class="token punctuation">}</span>
</code></pre></div><p>4.当发布成功之后，全局安装刚刚发布的包 <code>npm install -g my-cli</code>，安装完以后就可以在命令行使用步骤2中的命令了
<code>$ command-name</code></p> <h3 id="unix-like-平台"><a href="#unix-like-平台" class="header-anchor">#</a> Unix-like 平台</h3> <p>当全局安装 <code>npm</code> 包的时候，<code>npm</code> 会把 <code>package.json</code> 中 <code>bin</code> 配置的
<code>command-name</code> 添加到系统 <code>$PATH</code> 中去。拿 <code>macOS</code> 举例，
<code>npm</code> 会在 <code>/usr/local/bin</code> 下创建一个以 <code>command-name</code> 为名字的软链接，指向全局安装下来的 <code>my-cli</code> 包下面的
<code>js:jsfile</code>。
（<code>/usr/local/bin</code> 是在 <code>$PATH</code> 中的）</p> <p>在命令行键入<code>command-name</code> 相当于执行了文本文件 <code>jsfile</code>。</p> <p>在执行的时候碰到第一行 <code>#!/usr/bin/env node</code>，这是一个 <code>shebang</code> 行。这行告诉系统使用 <code>node</code> 去执行当前文件。
（<code>shebang</code> 只有在<code>Unix-like</code>平台才有）
执行 <code>js</code> 文件。这里有一个问题：<code>#!</code> 并不是一个符合 <code>js</code> 语法的语句，理论上直接执行是会有
<code>syntax error</code> 的。但是 <code>node</code> 对 <code>shebang</code> 行做了例外处理，所以用 <code>node</code> 执行带 <code>shebang</code> 行的 <code>js</code> 文件是没有问题的。</p> <h3 id="windows-平台"><a href="#windows-平台" class="header-anchor">#</a> Windows 平台</h3> <p>全局安装会把包安装到 <code>C:\Users\username\AppData\Roaming\npm\node_modules</code>下面，
然后在<code>C:\Users\username\AppData\Roaming\npm</code> 生成一个
以 <code>command-name</code> 为名字的 <code>cmd</code> 文件：<code>command-name.cmd</code>。<code>（C:\Users\username\AppData\Roaming\npm</code> 在安装
<code>npm</code> 时被加入到 <code>%PATH%</code>中）
在 <code>Windows</code> 平台运行 <code>cmd</code> 文件是不需要后缀名的，所以当在命令行键入 <code>command-name</code>
相当于执行 <code>C:\Users\username\AppData\Roaming\npm\command-name.cmd</code>。
为什么有这个 <code>cmd</code> 文件，因为 <code>windows</code> 平台没有 <code>shebang</code>，那么 <code>command-name.cmd</code>
就模拟了 <code>#!/usr/bin/env node</code> 的功能，调用 <code>C:\Users\username\AppData\Roaming\npm\node_modules\my-cli\ jsfile</code></p> <h3 id="本地开发-cli-测试"><a href="#本地开发-cli-测试" class="header-anchor">#</a> 本地开发 cli 测试</h3> <p>在没有发布到 <code>npm</code> 平台，我们在 <code>package.json</code> 可以添加</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
   <span class="token property">&quot;bin&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;command-name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;jsfile&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>安装一来后然后执行 <code>npm init</code> ,即可本地使用这个命令</p> <h2 id="引用"><a href="#引用" class="header-anchor">#</a> 引用</h2> <ul><li><a href="https://segmentfault.com/a/1190000015218126" target="_blank" rel="noopener noreferrer">npm包来制作命令行工具的原理<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="今日图-猜猜这个是谁？"><a href="#今日图-猜猜这个是谁？" class="header-anchor">#</a> 今日图 - 猜猜这个是谁？</h2> <p><img src="/assets/img/e5f879a92a3c190ff5e29dd7146f4611.36e4bbef.gif" alt="e5f879a92a3c190ff5e29dd7146f4611.gif"></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Weibozzz/Weibozzz.github.io/edit/master/docs/其他/npm发布包一些注意事项和流程.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/15/2019, 6:18:44 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.687d257c.js" defer></script><script src="/assets/js/34.5cabc593.js" defer></script><script src="/assets/js/65.19408c2b.js" defer></script>
  </body>
</html>
