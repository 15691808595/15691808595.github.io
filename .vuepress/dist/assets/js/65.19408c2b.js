(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{162:function(s,t,a){s.exports=a.p+"assets/img/e5f879a92a3c190ff5e29dd7146f4611.36e4bbef.gif"},236:function(s,t,a){"use strict";a.r(t);var n=a(0),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"npm发布包"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#npm发布包"}},[s._v("#")]),s._v(" npm发布包")]),s._v(" "),n("h2",{attrs:{id:"初始化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#初始化"}},[s._v("#")]),s._v(" 初始化")]),s._v(" "),n("p",[s._v("在"),n("a",{attrs:{href:"https://www.npmjs.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.npmjs.com/"),n("OutboundLink")],1),s._v("这里注册登录，\n起一个名字，比如http-auth-zfb,首先查询是否已存在")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" http-auth-zfb\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" http-auth-zfb\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" init -y\n")])])]),n("h2",{attrs:{id:"新建入口文件-index-js"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#新建入口文件-index-js"}},[s._v("#")]),s._v(" 新建入口文件 index.js")]),s._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//index.js")]),s._v("\nmodule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./lib/index'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n")])])]),n("p",[s._v("要发布的文件放到lib文件夹下")]),s._v(" "),n("h2",{attrs:{id:"发布"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#发布"}},[s._v("#")]),s._v(" 发布")]),s._v(" "),n("p",[n("code",[s._v("npm login")]),s._v("登录会填写你在"),n("code",[s._v("npmjs.com")]),s._v("注册的用户名密码邮箱等信息。")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" login\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" publish\n")])])]),n("h2",{attrs:{id:"更新发布"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#更新发布"}},[s._v("#")]),s._v(" 更新发布")]),s._v(" "),n("p",[s._v("只需要更改版本号然后"),n("code",[s._v("npm publish")])]),s._v(" "),n("h2",{attrs:{id:"如果发布的有es6代码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#如果发布的有es6代码"}},[s._v("#")]),s._v(" 如果发布的有es6代码")]),s._v(" "),n("p",[s._v("新建"),n("code",[s._v("src")]),s._v("目录，把原始文件（es6代码），放入"),n("code",[s._v("src")]),s._v(",需要"),n("code",[s._v("babael")]),s._v("转化")]),s._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"test"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo \\"Error: no test specified\\" && exit 1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"build"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"babel src --out-dir lib"')]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"devDependencies"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"babel-cli"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^6.26.0"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"babel-plugin-transform-runtime"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^6.23.0"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"babel-preset-es2015"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^6.24.1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"babel-preset-stage-3"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^6.24.1"')]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"dependencies"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"transform-runtime"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^0.0.0"')]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),n("p",[s._v("发布前，执行"),n("code",[s._v("npm run build")]),s._v("转化后的代码会在lib下面，更改版本号，在执行"),n("code",[s._v("npm publish")])]),s._v(" "),n("h2",{attrs:{id:"错误"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#错误"}},[s._v("#")]),s._v(" 错误")]),s._v(" "),n("p",[n("code",[s._v("npm ERR! publish Failed PUT 401")]),s._v("\n解决过程：")]),s._v(" "),n("ol",[n("li",[n("p",[s._v("检查仓库是否被设成了淘宝镜像库\n"),n("code",[s._v("npm config get registry")])])]),s._v(" "),n("li",[n("p",[s._v("如是，则设回原仓库\n"),n("code",[s._v("npm config set registry=http://registry.npmjs.org")])])]),s._v(" "),n("li",[n("p",[s._v("登录账号（如未登录）\n"),n("code",[s._v("npm login")]),s._v(" 或者添加用户 "),n("code",[s._v("npm adduser")])])]),s._v(" "),n("li",[n("p",[s._v("再次发布\n"),n("code",[s._v("npm publish")])])]),s._v(" "),n("li",[n("p",[s._v("如发布成功，则再次将仓库地址设为淘宝镜像地址\n"),n("code",[s._v("npm config set registry=https://registry.npm.taobao.org/")])])])]),s._v(" "),n("h2",{attrs:{id:"npm包来制作命令行工具的原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#npm包来制作命令行工具的原理"}},[s._v("#")]),s._v(" npm包来制作命令行工具的原理")]),s._v(" "),n("blockquote",[n("p",[s._v("用过构建工具的亲们知道，通常通过全局安装一个 xxx-cli 的 npm 包，\n就能在命令行用命令进行构建。那么这个 npm 包如何变成一个可执行的命令呢？")])]),s._v(" "),n("p",[s._v("1.使用 "),n("code",[s._v("npm init")]),s._v(" 初始化一个项目目录 "),n("code",[s._v("my-cli")]),s._v("。")]),s._v(" "),n("p",[s._v("2.在 "),n("code",[s._v("package.json")]),s._v(" 中添加或者编辑 "),n("code",[s._v("bin")]),s._v(" 字段：")]),s._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('{\n  "name": "my-cli",\n  ...,\n  "bin": {\n    "command-name": "jsfile" // path of jsfile relative to package.json\n  },\n  ...\n}\n')])])]),n("p",[n("code",[s._v("commandName")]),s._v(" 就是命令的名字，"),n("code",[s._v("jsfile")]),s._v(" 就是当用户键入命令时的处理程序。")]),s._v(" "),n("p",[s._v("3.代码开发。必须在 "),n("code",[s._v("jsfile")]),s._v(" 文件的第一行写这行命令 "),n("code",[s._v("#!/usr/bin/env node")]),s._v("，譬如：")]),s._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("#"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("env node\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" program "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'commander'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" packageJson "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'../package'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" defaultJsProcessors "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'react'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" defaultStyleProcessors "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sasslike'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" defaultWebpackVersion "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'4'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("parseListArgv")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("val")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" val "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" val"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("split")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("','")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nprogram\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" packageJson"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("version"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-v, --version'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("option")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-u, --use-version <version-number>'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Webpack version'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("option")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-j, --js-processors <processors>'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Specify javascript processors'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" parseListArgv "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("option")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-s, --style-processors <processors>'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Specify style(css,image,fonts) processors'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" parseListArgv "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("option")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--no-install'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Do not install devDependncies package'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("parse")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("argv "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" jsProcessors "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" program"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jsProcessors "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" defaultJsProcessors"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" styleProcessors "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" program"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("styleProcessors "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" defaultStyleProcessors"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" webpackVersion "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" program"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("useVersion "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" defaultWebpackVersion"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" webpackVersion"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'4'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// code")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// code")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),n("p",[s._v("4.当发布成功之后，全局安装刚刚发布的包 "),n("code",[s._v("npm install -g my-cli")]),s._v("，安装完以后就可以在命令行使用步骤2中的命令了\n"),n("code",[s._v("$ command-name")])]),s._v(" "),n("h3",{attrs:{id:"unix-like-平台"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#unix-like-平台"}},[s._v("#")]),s._v(" Unix-like 平台")]),s._v(" "),n("p",[s._v("当全局安装 "),n("code",[s._v("npm")]),s._v(" 包的时候，"),n("code",[s._v("npm")]),s._v(" 会把 "),n("code",[s._v("package.json")]),s._v(" 中 "),n("code",[s._v("bin")]),s._v(" 配置的\n"),n("code",[s._v("command-name")]),s._v(" 添加到系统 "),n("code",[s._v("$PATH")]),s._v(" 中去。拿 "),n("code",[s._v("macOS")]),s._v(" 举例，\n"),n("code",[s._v("npm")]),s._v(" 会在 "),n("code",[s._v("/usr/local/bin")]),s._v(" 下创建一个以 "),n("code",[s._v("command-name")]),s._v(" 为名字的软链接，指向全局安装下来的 "),n("code",[s._v("my-cli")]),s._v(" 包下面的\n"),n("code",[s._v("js:jsfile")]),s._v("。\n（"),n("code",[s._v("/usr/local/bin")]),s._v(" 是在 "),n("code",[s._v("$PATH")]),s._v(" 中的）")]),s._v(" "),n("p",[s._v("在命令行键入"),n("code",[s._v("command-name")]),s._v(" 相当于执行了文本文件 "),n("code",[s._v("jsfile")]),s._v("。")]),s._v(" "),n("p",[s._v("在执行的时候碰到第一行 "),n("code",[s._v("#!/usr/bin/env node")]),s._v("，这是一个 "),n("code",[s._v("shebang")]),s._v(" 行。这行告诉系统使用 "),n("code",[s._v("node")]),s._v(" 去执行当前文件。\n（"),n("code",[s._v("shebang")]),s._v(" 只有在"),n("code",[s._v("Unix-like")]),s._v("平台才有）\n执行 "),n("code",[s._v("js")]),s._v(" 文件。这里有一个问题："),n("code",[s._v("#!")]),s._v(" 并不是一个符合 "),n("code",[s._v("js")]),s._v(" 语法的语句，理论上直接执行是会有\n"),n("code",[s._v("syntax error")]),s._v(" 的。但是 "),n("code",[s._v("node")]),s._v(" 对 "),n("code",[s._v("shebang")]),s._v(" 行做了例外处理，所以用 "),n("code",[s._v("node")]),s._v(" 执行带 "),n("code",[s._v("shebang")]),s._v(" 行的 "),n("code",[s._v("js")]),s._v(" 文件是没有问题的。")]),s._v(" "),n("h3",{attrs:{id:"windows-平台"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#windows-平台"}},[s._v("#")]),s._v(" Windows 平台")]),s._v(" "),n("p",[s._v("全局安装会把包安装到 "),n("code",[s._v("C:\\Users\\username\\AppData\\Roaming\\npm\\node_modules")]),s._v("下面，\n然后在"),n("code",[s._v("C:\\Users\\username\\AppData\\Roaming\\npm")]),s._v(" 生成一个\n以 "),n("code",[s._v("command-name")]),s._v(" 为名字的 "),n("code",[s._v("cmd")]),s._v(" 文件："),n("code",[s._v("command-name.cmd")]),s._v("。"),n("code",[s._v("（C:\\Users\\username\\AppData\\Roaming\\npm")]),s._v(" 在安装\n"),n("code",[s._v("npm")]),s._v(" 时被加入到 "),n("code",[s._v("%PATH%")]),s._v("中）\n在 "),n("code",[s._v("Windows")]),s._v(" 平台运行 "),n("code",[s._v("cmd")]),s._v(" 文件是不需要后缀名的，所以当在命令行键入 "),n("code",[s._v("command-name")]),s._v("\n相当于执行 "),n("code",[s._v("C:\\Users\\username\\AppData\\Roaming\\npm\\command-name.cmd")]),s._v("。\n为什么有这个 "),n("code",[s._v("cmd")]),s._v(" 文件，因为 "),n("code",[s._v("windows")]),s._v(" 平台没有 "),n("code",[s._v("shebang")]),s._v("，那么 "),n("code",[s._v("command-name.cmd")]),s._v("\n就模拟了 "),n("code",[s._v("#!/usr/bin/env node")]),s._v(" 的功能，调用 "),n("code",[s._v("C:\\Users\\username\\AppData\\Roaming\\npm\\node_modules\\my-cli\\ jsfile")])]),s._v(" "),n("h3",{attrs:{id:"本地开发-cli-测试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#本地开发-cli-测试"}},[s._v("#")]),s._v(" 本地开发 cli 测试")]),s._v(" "),n("p",[s._v("在没有发布到 "),n("code",[s._v("npm")]),s._v(" 平台，我们在 "),n("code",[s._v("package.json")]),s._v(" 可以添加")]),s._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"bin"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"command-name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jsfile"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),n("p",[s._v("安装一来后然后执行 "),n("code",[s._v("npm init")]),s._v(" ,即可本地使用这个命令")]),s._v(" "),n("h2",{attrs:{id:"引用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#引用"}},[s._v("#")]),s._v(" 引用")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://segmentfault.com/a/1190000015218126",target:"_blank",rel:"noopener noreferrer"}},[s._v("npm包来制作命令行工具的原理"),n("OutboundLink")],1)])]),s._v(" "),n("h2",{attrs:{id:"今日图-猜猜这个是谁？"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#今日图-猜猜这个是谁？"}},[s._v("#")]),s._v(" 今日图 - 猜猜这个是谁？")]),s._v(" "),n("p",[n("img",{attrs:{src:a(162),alt:"e5f879a92a3c190ff5e29dd7146f4611.gif"}})])])}),[],!1,null,null,null);t.default=e.exports}}]);